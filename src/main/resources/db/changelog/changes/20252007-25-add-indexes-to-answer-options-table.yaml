databaseChangeLog:
  # =====================================================================
  # 29-QADAM: "answer_options" JADVALIGA MAXSUS INDEKS QO'SHISH
  # =====================================================================
  - changeSet:
      id: 20252007-29-add-indexes-to-answer-options-table
      author: Eldor04
      dbms: "postgresql"
      comment: "Step 29: Adding a composite unique index on (question_id, text) for data integrity and performance"
      changes:
        - sql:
            sql: |
              CREATE UNIQUE INDEX idx_answer_option_text_per_question_unique_not_deleted
              ON answer_options (question_id, text)
              WHERE deleted = false;
      rollback:
        - dropIndex:
            indexName: idx_answer_option_text_per_question_unique_not_deleted
            tableName: answer_options